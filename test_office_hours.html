<!DOCTYPE html>
<html>
<head>
    <title>Office Hours Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-case { margin: 10px 0; padding: 10px; border: 1px solid #ccc; }
        .late { background-color: #ffebee; color: #c62828; }
        .early { background-color: #ffebee; color: #c62828; }
        .normal { background-color: #e8f5e8; color: #2e7d32; }
    </style>
</head>
<body>
    <h1>Office Hours Test</h1>
    <p>Testing attendance cell formatting with office hours (Login: 10:00, Logout: 18:00)</p>
    
    <div id="test-results"></div>

    <script>
        // Test data
        const testCases = [
            { time: "09:30", expected: "normal", description: "Early arrival (9:30 AM)" },
            { time: "10:00", expected: "normal", description: "On-time arrival (10:00 AM)" },
            { time: "10:15", expected: "late", description: "Late arrival (10:15 AM)" },
            { time: "10:00 - 17:30", expected: "early", description: "Early departure (5:30 PM)" },
            { time: "10:00 - 18:00", expected: "normal", description: "On-time departure (6:00 PM)" },
            { time: "10:00 - 18:30", expected: "normal", description: "Late departure (6:30 PM)" },
            { time: "10:30 - 17:45", expected: "late early", description: "Late arrival + Early departure" },
            { time: "", expected: "normal", description: "No attendance" }
        ];

        const officeHours = { loginTime: "10:00", logoutTime: "18:00" };

        function isTimeLate(timeStr, idealTime) {
            if (!timeStr || !idealTime) return false;
            
            const [timeHour, timeMin] = timeStr.split(':').map(Number);
            const [idealHour, idealMin] = idealTime.split(':').map(Number);
            
            const timeMinutes = timeHour * 60 + timeMin;
            const idealMinutes = idealHour * 60 + idealMin;
            
            return timeMinutes > idealMinutes;
        }

        function isTimeEarly(timeStr, idealTime) {
            if (!timeStr || !idealTime) return false;
            
            const [timeHour, timeMin] = timeStr.split(':').map(Number);
            const [idealHour, idealMin] = idealTime.split(':').map(Number);
            
            const timeMinutes = timeHour * 60 + timeMin;
            const idealMinutes = idealHour * 60 + idealMin;
            
            return timeMinutes < idealMinutes;
        }

        function formatAttendanceCell(timeDisplay, loginTime, logoutTime) {
            if (!timeDisplay) return { content: '', className: 'normal' };
            
            // Handle both "HH:MM" and "HH:MM - HH:MM" formats
            const parts = timeDisplay.split(' - ');
            const arrivalTime = parts[0];
            const departureTime = parts[1] || '';
            
            let className = 'normal';
            
            // Check for late arrival
            if (isTimeLate(arrivalTime, loginTime)) {
                className = 'late';
            }
            
            // Check for early departure (only if both arrival and departure times exist)
            if (departureTime && isTimeEarly(departureTime, logoutTime)) {
                className = className === 'late' ? 'late early' : 'early';
            }
            
            return { content: timeDisplay, className };
        }

        // Run tests
        const resultsDiv = document.getElementById('test-results');
        
        testCases.forEach((testCase, index) => {
            const result = formatAttendanceCell(testCase.time, officeHours.loginTime, officeHours.logoutTime);
            const isCorrect = result.className === testCase.expected;
            
            const testDiv = document.createElement('div');
            testDiv.className = `test-case ${result.className}`;
            testDiv.innerHTML = `
                <strong>Test ${index + 1}:</strong> ${testCase.description}<br>
                <strong>Input:</strong> "${testCase.time}"<br>
                <strong>Expected:</strong> ${testCase.expected}<br>
                <strong>Got:</strong> ${result.className}<br>
                <strong>Status:</strong> ${isCorrect ? '✅ PASS' : '❌ FAIL'}
            `;
            resultsDiv.appendChild(testDiv);
        });
    </script>
</body>
</html>
